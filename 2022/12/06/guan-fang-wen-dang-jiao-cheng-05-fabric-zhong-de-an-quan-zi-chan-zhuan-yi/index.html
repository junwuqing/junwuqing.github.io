<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="官方文档教程05-Fabric 中的安全资产转移~, somewei">
    <meta name="description" content="官方文档教程05-Fabric 中的安全资产转移本教程将演示如何在Hyperledger Fabric区块链channel中的组织之间的表示和交易资产，同时使用私有数据保持资产和交易的详细信息。每个链上资产都是一个不可替代的令牌（NFT），">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>官方文档教程05-Fabric 中的安全资产转移~ | somewei</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.2"></head>


<body>
    

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">somewei</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">somewei</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/20.webp')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">官方文档教程05-Fabric 中的安全资产转移~</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E6%95%99%E7%A8%8B%E7%B1%BB/">
                                <span class="chip bg-color">教程类</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-12-06
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    6k
                </div>
                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="官方文档教程05-Fabric-中的安全资产转移"><a href="#官方文档教程05-Fabric-中的安全资产转移" class="headerlink" title="官方文档教程05-Fabric 中的安全资产转移"></a>官方文档教程05-Fabric 中的安全资产转移</h1><p>本教程将演示如何在Hyperledger Fabric区块链channel中的组织之间的表示和交易资产，同时使用私有数据保持资产和交易的详细信息。每个链上资产都是一个不可替代的令牌（NFT），它代表一个特定的资产，该资产具有特定的不可改变的属性（如大小和颜色），并且具有唯一的所有者。当所有者要出售资产时，双方需要在资产转让前商定相同的价格。私人资产转让智能合约强制规定，只有资产所有者才能转让资产。在本教程中，您将了解Fabric特性（如基于状态的背书、私有数据和访问控制）如何组合在一起，以提供既私有又可验证的安全事务。</p>
<p>本教程将部署安全资产转移示例，以演示如何在不公开共享数据的情况下在两个组织之间转移私有资产。 您应该已经完成安装示例、二进制文件和 Docker 映像任务。</p>
<h2 id="1-场景需求"><a href="#1-场景需求" class="headerlink" title="1.场景需求"></a>1.场景需求</h2><p>私有资产转移场景受以下要求约束：</p>
<ul>
<li>资产可以由第一所有人的组织发行（在现实世界中，发行可能仅限于某个认证资产属性的权威机构）。</li>
<li>所有权在组织级别进行管理（Fabric 许可方案同样支持组织内个人身份级别的所有权）。</li>
<li>资产标识符是资产不可变属性的散列，与当前所有者一起作为公共channel数据存储，供所有channel成员查看。<br>然而，资产不可变属性是只有资产所有者（和先前所有者）知道的私有信息。</li>
<li>感兴趣的买家会希望在购买前根据哈希资产 ID 验证资产的私有属性。 这确认买方具有正确的资产描述。</li>
<li>有兴趣的买家会想要验证资产的来源，特别是资产的来源和监管链。 这证实资产自发行以来没有变化。</li>
<li>要转让资产，买卖双方必须首先就资产的属性和销售价格达成一致。</li>
<li>只有当前所有者可以将他们的资产转让给另一个组织。</li>
<li>实际的私人资产转让必须验证资产的属性和价格已经达成一致。 买卖双方都必须背书转让。</li>
</ul>
<h2 id="2-如何维护隐私"><a href="#2-如何维护隐私" class="headerlink" title="2.如何维护隐私"></a>2.如何维护隐私</h2><p>智能合约使用以下技术来确保资产属性保持私有：</p>
<ul>
<li>资产属性仅存储在当前所属组织的隐式私有数据集合中。Fabric channel上的每个组织都有自己的组织可以使用的私有数据集合。此集合是隐式的，因为它不需要在链码中显式定义。</li>
<li>尽管私有属性的哈希值自动存储在链上，以供所有的channel成员查看，但是私有属性中包含一个随机salt，这样其他channel成员就无法通过字典式攻击猜测私有数据原像。</li>
<li>智能合约请求利用私有数据的transient字段，这样私有数据就不会包含在最终的链上交易中。</li>
<li>私有数据查询必须源自其组织 ID 与peer组织 ID 匹配的客户端，该组织 ID 必须与资产所有者的组织 ID 相同。</li>
</ul>
<h2 id="3-转移是如何实施的"><a href="#3-转移是如何实施的" class="headerlink" title="3.转移是如何实施的"></a>3.转移是如何实施的</h2><p>在我们开始使用私有资产转移智能合约之前，我们将概述交易流程以及如何使用 Fabric 功能来保护在区块链上创建的资产：</p>
<h3 id="3-1创建资产"><a href="#3-1创建资产" class="headerlink" title="3.1创建资产"></a>3.1创建资产</h3><p>私有资产转移智能合约部署有背书策略，需要所有channel成员的背书。这允许所有组织创建他们拥有的资产，而无需其他channel成员的认可。资产的创建是唯一使用链码级背书策略的交易。Transactions that update or transfer existing assets will be governed by state based endorsement policies or the endorsement policies of private data collections. 请注意，在其他情况下，您可能希望发行机构也为创建交易背书。</p>
<p>智能合约使用以下 Fabric 功能来确保资产只能由拥有资产的组织更新或转移：</p>
<ul>
<li>当资产被创建时，智能合约获取提交请求的组织的 MSP ID，并将 MSP ID 作为所有者存储在公共链码世界状态中的资产键/值中。 随后更新或转移资产的智能合约请求将使用访问控制逻辑来验证请求客户端是否来自同一组织。 请注意，在其他情况下，所有权可能基于组织内特定的客户端身份，而不是组织本身。</li>
<li>此外，在创建资产时，智能合约会为资产密钥设置基于状态的背书策略。 基于状态的策略指定来自拥有资产的组织的peer必须认可更新或转移资产的后续请求。 这可以防止任何其他组织使用被恶意更改的智能合约来更新或启动资产转移。 为了进一步确保资产转移的安全，请考虑将其他方纳入资产的基于状态的背书策略中，例如受信任的第三方。</li>
</ul>
<h3 id="3-2同意转让"><a href="#3-2同意转让" class="headerlink" title="3.2同意转让"></a>3.2同意转让</h3><p>资产创建后，channel成员可以使用智能合约同意转让资产：</p>
<ul>
<li>资产的所有者可以更改公共所有权记录中的描述，例如，发布资产待售的广告。智能合约访问控制强制要求此更改必须是由资产所有者组织的成员提交的。基于状态的背书策略强制要求此描述更改必须由所有者组织的同行背书。</li>
</ul>
<p>资产所有者和资产购买者约定以一定价格转让资产：</p>
<ul>
<li>买卖双方约定的价格和私有资产属性存储在每个组织的隐性私有数据集合中。 channel的其他成员无法查看私有数据集合中商定的价格和资产属性。隐式私有数据收集的背书策略确保相应组织的同行对价格协议进行背书，智能合约访问控制逻辑确保价格协议由相关组织的客户提交。</li>
<li>使用私有数据集合时，每个价格协议和资产属性的哈希值会自动存储在ledger中。 只有当两个组织同意相同的价格并且两个资产描述一致时，这些哈希值才会匹配。 这允许组织在执行和背书转账交易时验证他们是否已就转账细节达成一致。 在价格协议中加入一个随机的交易ID，作为一个salt，以确保其他channel成员不能使用哈希的ledger来猜测价格。</li>
</ul>
<h3 id="3-3转移资产"><a href="#3-3转移资产" class="headerlink" title="3.3转移资产"></a>3.3转移资产</h3><p>在两个组织同意相同的价格和资产属性后，资产所有者可以调用转移函数将资产转移给买方：</p>
<ul>
<li>智能合约访问控制确保转移必须由拥有资产的组织成员发起。</li>
<li>转移功能通过比较哈希值来验证卖方私有集合中存在的链上资产属性与买方私有集合中存在的资产属性相对应，以确保资产所有者出售的是相同的资产。</li>
<li>转移功能还使用ledger上价格协议的哈希值来确保两个组织都同意相同的价格。</li>
<li>如果满足转移条件，转移函数会从卖方的集合中删除资产，并更新公共所有权记录中的所有者。</li>
<li>买卖双方隐含的隐私数据集合中也删除了价格协议，并在每个隐私数据集合中创建销售收据以记录交易价格和时间戳。</li>
<li>由于转账交易更新了买卖双方隐式数据集合中的数据，因此转账必须得到买卖双方的peer节点的背书。</li>
<li>更新公共资产记录的基于状态的背书策略，以便只有资产新所有者的peer才能更新或初始化其新资产的后续转移。</li>
</ul>
<h2 id="4-运行安全资产转移智能合约"><a href="#4-运行安全资产转移智能合约" class="headerlink" title="4.运行安全资产转移智能合约"></a>4.运行安全资产转移智能合约</h2><p>您可以使用 Fabric 测试网络来运行安全资产转移智能合约。 test-network包含两个peer组织，Org1 和 Org2，每个组织运行一个peer。 在本教程中，我们会将智能合约部署到两个组织加入的test-network的channel中。 我们将首先创建一个由 Org1 拥有的资产。 在两个组织就资产属性和价格达成一致后，我们将资产从 Org1 转移到 Org2。</p>
<h2 id="5-部署test-network网络"><a href="#5-部署test-network网络" class="headerlink" title="5.部署test-network网络"></a>5.部署test-network网络</h2><p>我们将使用 Fabric 测试网络来运行安全资产转移智能合约。 打开命令终端并导航到本地 fabric-samples 克隆中的test-network目录。 在本教程的其余部分，我们将从 test-network 目录进行操作。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> fabric-samples/test-network<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>首先，关闭所有正在运行的测试网络实例：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./network.sh down<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>然后，您可以使用以下命令在网络中部署一个新实例：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./network.sh up createChannel <span class="token parameter variable">-c</span> mychannel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>该脚本将部署网络的节点并创建一个名为 mychannel 的channel，并将 Org1 和 Org2 作为channel成员。 我们将使用此channel部署智能合约并交易我们的资产。</p>
<h2 id="6-部署智能合约"><a href="#6-部署智能合约" class="headerlink" title="6.部署智能合约"></a>6.部署智能合约</h2><p>您可以使用测试网络脚本将安全资产转移智能合约部署到通道中。 运行以下命令将智能合约部署到 mychannel：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./network.sh deployCC <span class="token parameter variable">-ccn</span> secured <span class="token parameter variable">-ccp</span> <span class="token punctuation">..</span>/asset-transfer-secured-agreement/chaincode-go/ <span class="token parameter variable">-ccl</span> go <span class="token parameter variable">-ccep</span> <span class="token string">"OR('Org1MSP.peer','Org2MSP.peer')"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>请注意，我们使用 -ccep 标志来部署具有“OR(‘Org1MSP.peer’,’Org2MSP.peer’)”背书策略的智能合约。 这允许任何一个组织在没有得到另一个组织的认可的情况下创建资产。</p>
<h3 id="6-1设置环境变量以作为-Org1-操作"><a href="#6-1设置环境变量以作为-Org1-操作" class="headerlink" title="6.1设置环境变量以作为 Org1 操作"></a>6.1设置环境变量以作为 Org1 操作</h3><p>在运行此示例的过程中，您需要以 Org1 和 Org2 的身份与网络进行交互。 为了使教程更易于使用，我们将为每个组织使用单独的终端。 打开一个新终端并确保您正在从 test-network 目录进行操作。 设置以下环境变量以作为 Org1 管理员操作peer CLI：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/<span class="token punctuation">..</span>/bin:<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span><span class="token builtin class-name">:</span><span class="token environment constant">$PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">FABRIC_CFG_PATH</span><span class="token operator">=</span><span class="token environment constant">$PWD</span>/<span class="token punctuation">..</span>/config/
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_TLS_ENABLED</span><span class="token operator">=</span>true
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_LOCALMSPID</span><span class="token operator">=</span><span class="token string">"Org1MSP"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_MSPCONFIGPATH</span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_ADDRESS</span><span class="token operator">=</span>localhost:7051<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>环境变量还指定了 Org1 节点的端点信息以提交请求。</p>
<h3 id="6-2设置环境变量以作为-Org2-操作"><a href="#6-2设置环境变量以作为-Org2-操作" class="headerlink" title="6.2设置环境变量以作为 Org2 操作"></a>6.2设置环境变量以作为 Org2 操作</h3><p>现在我们有了一个可以作为 Org1 运行的终端，为 Org2 打开一个新终端。 确保此终端也在test-network目录中运行。 设置以下环境变量以作为 Org2 管理员运行：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/<span class="token punctuation">..</span>/bin:<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span><span class="token builtin class-name">:</span><span class="token environment constant">$PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">FABRIC_CFG_PATH</span><span class="token operator">=</span><span class="token environment constant">$PWD</span>/<span class="token punctuation">..</span>/config/
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_TLS_ENABLED</span><span class="token operator">=</span>true
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_LOCALMSPID</span><span class="token operator">=</span><span class="token string">"Org2MSP"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_MSPCONFIGPATH</span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CORE_PEER_ADDRESS</span><span class="token operator">=</span>localhost:9051<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在学习本教程时，您需要在两个终端之间切换。</p>
<h2 id="7-创建资产"><a href="#7-创建资产" class="headerlink" title="7.创建资产"></a>7.创建资产</h2><p>任何channel成员都可以使用智能合约来创建归其组织所有的资产。 资产的详细信息将存储在私有数据集合中，并且只能由拥有资产的组织访问。 资产的公共记录、其所有者和公共描述存储在channel ledger中。 任何channel成员都可以访问公共所有权记录以查看谁拥有该资产，并可以阅读描述以查看该资产是否待售。</p>
<h2 id="8-从-Org1-终端操作"><a href="#8-从-Org1-终端操作" class="headerlink" title="8.从 Org1 终端操作"></a>8.从 Org1 终端操作</h2><p>在创建资产之前，我们需要指定资产的详细信息。 发出以下命令以创建将描述资产的 JSON。 “salt”参数是一个随机字符串，可以防止通道的另一个成员使用分类账上的哈希猜测资产。 如果没有salt，用户理论上可以猜测资产参数，直到猜测的哈希值与ledger上的哈希值相匹配（这被称为字典攻击）。 此字符串以 Base64 格式编码，以便它可以作为临时数据传递给创建交易。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_PROPERTIES</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>object_type<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>asset_properties<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>color<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>blue<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>size<span class="token entity" title="\&quot;">\"</span>:35,<span class="token entity" title="\&quot;">\"</span>salt<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>a94a8fe5ccb19ba61c4c0873d391e987982fbbd3<span class="token entity" title="\&quot;">\"</span>&#125;"</span> <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>n<span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们现在可以使用以下命令创建属于 Org1 的资产。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">'&#123;"function":"CreateAsset","Args":["A new asset for Org1MSP"]&#125;'</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_properties<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PROPERTIES</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>资产属性的哈希将成为资产 ID 并由 CreateAsset 调用返回。 在报告给 CLI 的响应“有效负载”中查找哈希，并将其设置为环境变量以供以后参考。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_ID</span><span class="token operator">=</span>d9923f21b770adbc79cbcc47a3aeecc81dc7f030bd129155301ce3932be7fbcc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们可以查询 Org1 隐式数据集合以查看创建的资产，通过将 assetId 替换为从 createAsset 函数返回的 ID 来编写以下命令。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>GetAssetPrivateProperties<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>成功时，该命令将返回以下结果：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"object_type"</span><span class="token operator">:</span><span class="token string">"asset_properties"</span><span class="token punctuation">,</span><span class="token property">"color"</span><span class="token operator">:</span><span class="token string">"blue"</span><span class="token punctuation">,</span><span class="token property">"size"</span><span class="token operator">:</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token property">"salt"</span><span class="token operator">:</span><span class="token string">"a94a8fe5ccb19ba61c4c0873d391e987982fbbd3"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们还可以查询ledger以查看公共所有权记录：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ReadAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>该命令将返回资产归 Org1 所有的记录：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token string">"object_type"</span><span class="token builtin class-name">:</span><span class="token string">"asset"</span>,<span class="token string">"asset_id"</span><span class="token builtin class-name">:</span><span class="token string">"d9923f21b770adbc79cbcc47a3aeecc81dc7f030bd129155301ce3932be7fbcc"</span>,<span class="token string">"owner_org"</span><span class="token builtin class-name">:</span><span class="token string">"Org1MSP"</span>,<span class="token string">"public_description"</span><span class="token builtin class-name">:</span><span class="token string">"A new asset for Org1MSP"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>因为资产市场火爆，Org1 想把这个资产卖掉。 作为资产所有者，Org1 可以更新公共描述来宣传资产待售。 运行以下命令更改资产描述：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ChangePublicDescription<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>This asset is for sale<span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>再次查询ledger以查看更新后的描述：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ReadAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们现在可以看到该资产正在出售：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"object_type"</span><span class="token operator">:</span><span class="token string">"asset"</span><span class="token punctuation">,</span><span class="token property">"asset_id"</span><span class="token operator">:</span><span class="token string">"d9923f21b770adbc79cbcc47a3aeecc81dc7f030bd129155301ce3932be7fbcc"</span><span class="token punctuation">,</span><span class="token property">"owner_org"</span><span class="token operator">:</span><span class="token string">"Org1MSP"</span><span class="token punctuation">,</span><span class="token property">"public_description"</span><span class="token operator">:</span><span class="token string">"This asset is for sale"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://hyperledger-fabric.readthedocs.io/en/latest/_images/transfer_assets_1.png" alt="Org1 creates a asset"></p>
<p>图 1：当 Org1 创建他们拥有的资产时，资产详细信息存储在 Org1 peer上的 Org1 隐式数据集合中。 公共所有权记录存储在channel世界状态中，并存储在 Org1 和 Org2 peer上。 资产密钥的哈希和资产详细信息的哈希在channel世界状态中也是可见的，并存储在两个组织的peer上。</p>
<p>单词解释：</p>
<ul>
<li>Secured asset transfer smart contract：安全资产转移智能合约</li>
<li>Channel World State：channel世界状态</li>
<li>private data collection：私人数据集合</li>
</ul>
<h2 id="9-从-Org2-终端操作"><a href="#9-从-Org2-终端操作" class="headerlink" title="9.从 Org2 终端操作"></a>9.从 Org2 终端操作</h2><p>如果我们从 Org2 终端操作，我们可以使用智能合约查询公共资产数据：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_ID</span><span class="token operator">=</span>d9923f21b770adbc79cbcc47a3aeecc81dc7f030bd129155301ce3932be7fbcc
peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ReadAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>从这个查询中，Org2 得知资产是待售的：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"object_type"</span><span class="token operator">:</span><span class="token string">"asset"</span><span class="token punctuation">,</span><span class="token property">"asset_id"</span><span class="token operator">:</span><span class="token string">"d9923f21b770adbc79cbcc47a3aeecc81dc7f030bd129155301ce3932be7fbcc"</span><span class="token punctuation">,</span><span class="token property">"owner_org"</span><span class="token operator">:</span><span class="token string">"Org1MSP"</span><span class="token punctuation">,</span><span class="token property">"public_description"</span><span class="token operator">:</span><span class="token string">"This asset is for sale"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在真实的链码中，您可能想要通过JSON 查询查询所有待售资产，或创建不同的销售密钥并使用密钥范围查询来查找当前待售资产。对 Org1 拥有的资产的公开描述的任何更改都需要得到 Org1 的认可。 背书策略通过链码中的访问控制策略得到加强，任何更新都需要由拥有资产的组织提交。 让我们看看如果 Org2 试图恶意更改公共描述会发生什么：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ChangePublicDescription<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>the worst asset<span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>智能合约不允许 Org2 访问资产的公开描述。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Error: endorsement failure during invoke. response: status:500 message:<span class="token string">"a client from Org2MSP cannot update the description of an asset owned by Org1MSP"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="10-同意出售资产"><a href="#10-同意出售资产" class="headerlink" title="10.同意出售资产"></a>10.同意出售资产</h2><p>要出售资产，买卖双方必须就资产价格达成一致，并确保他们在各自的私有数据集合中具有相同的资产属性。 每一方都将他们同意的价格存储在自己的私人数据集合中。 私有资产转移智能合约强制双方需要同意相同的价格和资产属性才能转移资产。</p>
<h2 id="11同意作为-Org1-出售"><a href="#11同意作为-Org1-出售" class="headerlink" title="11同意作为 Org1 出售"></a>11同意作为 Org1 出售</h2><p>从 Org1 终端操作。 Org1 将同意将资产价格设置为 110 美元。 trade_id 用作salt，以防止不是买家或卖家的channel成员猜测价格。 该值需要与资产属性一起通过电子邮件或其他通信在买卖双方之间进行带外传递。 买卖双方还可以对资产密钥加salt，防止channel内的其他成员猜测出售的资产。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_PRICE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>trade_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>109f4b3c50d7b0df729d299bc6f8e9ef9066971f<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>price<span class="token entity" title="\&quot;">\"</span>:110&#125;"</span> <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>n<span class="token variable">)</span></span>
peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>AgreeToSell<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_price<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PRICE</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>我们可以查询 Org1 私有数据集合来读取约定的售价：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>GetAssetSalesPrice<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="12-同意以-Org2-身份购买"><a href="#12-同意以-Org2-身份购买" class="headerlink" title="12.同意以 Org2 身份购买"></a>12.同意以 Org2 身份购买</h2><p>从 Org2 终端操作。 在同意购买之前运行以下命令以验证资产属性。 资产属性和salt将通过电子邮件或其他通信在买卖双方之间进行传递。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_PROPERTIES</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>object_type<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>asset_properties<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>color<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>blue<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>size<span class="token entity" title="\&quot;">\"</span>:35,<span class="token entity" title="\&quot;">\"</span>salt<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>a94a8fe5ccb19ba61c4c0873d391e987982fbbd3<span class="token entity" title="\&quot;">\"</span>&#125;"</span> <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>n<span class="token variable">)</span></span>
peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>VerifyAssetProperties<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_properties<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PROPERTIES</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>运行以下命令以同意以 100 美元购买资产 1。 截至目前，Org2 将同意与 Org1 不同的价格。 不用担心，这两个组织将在未来的步骤中同意相同的价格。 但是，我们可以使用这种暂时的分歧来测试如果买卖双方同意不同的价格会发生什么。 Org2 需要使用与 Org1 相同的 trade_id。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_PRICE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>trade_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>109f4b3c50d7b0df729d299bc6f8e9ef9066971f<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>price<span class="token entity" title="\&quot;">\"</span>:100&#125;"</span> <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>n<span class="token variable">)</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_PROPERTIES</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>object_type<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>asset_properties<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>color<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>blue<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>size<span class="token entity" title="\&quot;">\"</span>:35,<span class="token entity" title="\&quot;">\"</span>salt<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>a94a8fe5ccb19ba61c4c0873d391e987982fbbd3<span class="token entity" title="\&quot;">\"</span>&#125;"</span> <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>n<span class="token variable">)</span></span>
peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>AgreeToBuy<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_price<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PRICE</span><span class="token entity" title="\&quot;">\"</span>, <span class="token entity" title="\&quot;">\"</span>asset_properties<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PROPERTIES</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>您可以从 Org2 隐式数据集合中读取商定的购买价格：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>GetAssetBidPrice<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://hyperledger-fabric.readthedocs.io/en/latest/_images/transfer_assets_2.png" alt="Org1 and Org2 agree on transfer"></p>
<p>图 2：Org1 和 Org2 同意转移资产后，每个组织同意的价格存储在他们的私有数据集合中。 买卖双方的复合密钥用于防止与资产详细信息和资产所有权记录发生冲突。 商定的价格仅存储在每个组织的同行中。 然而，这两个协议的哈希值都存储在每个加入channel的peer的channel世界状态中。</p>
<h2 id="13-将资产从-Org1-转移到-Org2"><a href="#13-将资产从-Org1-转移到-Org2" class="headerlink" title="13.将资产从 Org1 转移到 Org2"></a>13.将资产从 Org1 转移到 Org2</h2><p>在两个组织就其价格和资产属性达成一致后，Org1 可以尝试将资产转移给 Org2。 智能合约中的私人资产转移功能使用ledger上的哈希来检查两个组织是否同意相同的价格。 该函数还将检查买卖双方私有集合的资产属性哈希，以检查转移的资产是否与 Org1 拥有的资产相同。</p>
<h3 id="13-1将资产作为-Org1-转移"><a href="#13-1将资产作为-Org1-转移" class="headerlink" title="13.1将资产作为 Org1 转移"></a>13.1将资产作为 Org1 转移</h3><p>从 Org1 终端操作。 资产的所有者需要发起转移。 请注意，下面的命令使用 –peerAddresses 标志来定位 Org1 和 Org2 的peer。 两个组织都需要认可转让。 另请注意，价格在传输请求中作为transient属性传递。 这是通过的，以便当前所有者可以确保以正确的价格转让正确的资产。 这些属性将由两个背书者根据链上哈希值进行检查。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>TransferAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Org2MSP<span class="token entity" title="\&quot;">\"</span>]&#125;"</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_price<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PRICE</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span> <span class="token parameter variable">--peerAddresses</span> localhost:7051 <span class="token parameter variable">--tlsRootCertFiles</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt"</span> <span class="token parameter variable">--peerAddresses</span> localhost:9051 <span class="token parameter variable">--tlsRootCertFiles</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>因为两个组织没有约定相同的价格，所以无法完成转让：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Error: endorsement failure during invoke. response: status:500 message:<span class="token string">"failed transfer verification: hash cf74b8ce092b637bd28f98f7cdd490534c102a0665e7c985d4f2ab9810e30b1c for passed price JSON &#123;<span class="token entity" title="\&quot;">\"</span>asset_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>d9923f21b770adbc79cbcc47a3aeecc81dc7f030bd129155301ce3932be7fbcc<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>trade_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>109f4b3c50d7b0df729d299bc6f8e9ef9066971f<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>price<span class="token entity" title="\&quot;">\"</span>:110&#125; does not match on-chain hash 09341dbb39e81fb50ccb3a81770254525318f777fad217ae49777487116cceb4, buyer hasn't agreed to the passed trade id and price"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>结果，Org1 和 Org2 就购买资产的价格达成了新的协议。 Org1 将资产价格降至 100：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ASSET_PRICE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>trade_id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>109f4b3c50d7b0df729d299bc6f8e9ef9066971f<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>price<span class="token entity" title="\&quot;">\"</span>:100&#125;"</span> <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>n<span class="token variable">)</span></span>
peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>AgreeToSell<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Org2MSP<span class="token entity" title="\&quot;">\"</span>]&#125;"</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_price<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PRICE</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>现在买卖双方已经同意相同的价格，Org1 可以将资产转让给 Org2。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>TransferAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Org2MSP<span class="token entity" title="\&quot;">\"</span>]&#125;"</span> <span class="token parameter variable">--transient</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>asset_price<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_PRICE</span><span class="token entity" title="\&quot;">\"</span>&#125;"</span> <span class="token parameter variable">--peerAddresses</span> localhost:7051 <span class="token parameter variable">--tlsRootCertFiles</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt"</span> <span class="token parameter variable">--peerAddresses</span> localhost:9051 <span class="token parameter variable">--tlsRootCertFiles</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>您可以查询资产所有权记录来验证是否转账成功。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ReadAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>该记录现在将 Org2 列为资产所有者：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token string">"object_type"</span><span class="token builtin class-name">:</span><span class="token string">"asset"</span>,<span class="token string">"asset_id"</span><span class="token builtin class-name">:</span><span class="token string">"&lt;asset1>"</span>,<span class="token string">"owner_org"</span><span class="token builtin class-name">:</span><span class="token string">"Org2MSP"</span>,<span class="token string">"public_description"</span><span class="token builtin class-name">:</span><span class="token string">"This asset is for sale"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://hyperledger-fabric.readthedocs.io/en/latest/_images/transfer_assets_3.png" alt="Org1 transfers the asset to Org2"></p>
<p>图3：资产转移后，资产明细放入Org2隐式数据集合中，从Org1隐式数据集合中删除。 因此，资产详细信息现在仅存储在 Org2 节点上。ledger上的资产所有权记录已更新，以反映该资产归 Org2 所有。</p>
<h3 id="13-2将资产作为-Org1-转移"><a href="#13-2将资产作为-Org1-转移" class="headerlink" title="13.2将资产作为 Org1 转移"></a>13.2将资产作为 Org1 转移</h3><p>从 Org2 终端操作。 现在 Org2 拥有资产，我们可以从 Org2 隐式数据集合中读取资产详细信息</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>GetAssetPrivateProperties<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Org2 现在可以更新资产公共描述：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode invoke <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ChangePublicDescription<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>This asset is not for sale<span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>查询ledger以验证资产不再出售：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">peer chaincode query <span class="token parameter variable">-o</span> localhost:7050 <span class="token parameter variable">--ordererTLSHostnameOverride</span> orderer.example.com <span class="token parameter variable">--tls</span> <span class="token parameter variable">--cafile</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">PWD</span>&#125;</span>/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem"</span> <span class="token parameter variable">-C</span> mychannel <span class="token parameter variable">-n</span> secured <span class="token parameter variable">-c</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>function<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>ReadAsset<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Args<span class="token entity" title="\&quot;">\"</span>:[<span class="token entity" title="\&quot;">\"</span><span class="token variable">$ASSET_ID</span><span class="token entity" title="\&quot;">\"</span>]&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="12-结束"><a href="#12-结束" class="headerlink" title="12.结束"></a>12.结束</h2><p>完成资产转移后，您可以关闭测试网络。 该命令将删除test-network的所有节点，并删除您创建的所有ledger数据：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./network.sh down<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">普信摩羯妈宝凤凰下头搞笑男</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://junwuqing.github.io/2022/12/06/guan-fang-wen-dang-jiao-cheng-05-fabric-zhong-de-an-quan-zi-chan-zhuan-yi/">http://junwuqing.github.io/2022/12/06/guan-fang-wen-dang-jiao-cheng-05-fabric-zhong-de-an-quan-zi-chan-zhuan-yi/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">普信摩羯妈宝凤凰下头搞笑男</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E6%95%99%E7%A8%8B%E7%B1%BB/">
                                    <span class="chip bg-color">教程类</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/12/07/guan-fang-wen-dang-jiao-cheng-06-shi-yong-couchdb/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/11.webp" class="responsive-img" alt="官方文档教程06-使用CouchDB">
                        
                        <span class="card-title">官方文档教程06-使用CouchDB</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-12-07
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            普信摩羯妈宝凤凰下头搞笑男
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%95%99%E7%A8%8B%E7%B1%BB/">
                        <span class="chip bg-color">教程类</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/12/05/guan-fang-wen-dang-jiao-cheng-04-zai-fabric-zhong-shi-yong-si-you-shu-ju/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/23.webp" class="responsive-img" alt="官方文档教程04-在Fabric中使用私有数据">
                        
                        <span class="card-title">官方文档教程04-在Fabric中使用私有数据</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-12-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            普信摩羯妈宝凤凰下头搞笑男
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%95%99%E7%A8%8B%E7%B1%BB/">
                        <span class="chip bg-color">教程类</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: somewei<br />'
            + '文章作者: 普信摩羯妈宝凤凰下头搞笑男<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022</span>
            
            <a href="/about" target="_blank">普信摩羯妈宝凤凰下头搞笑男</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">60k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/junwuqing" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1275017708@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1275017708" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1275017708" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/sakura.js"><\/script>');
            }
        </script>
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

    
        <script type="text/javascript">
        //只在桌面版网页启用特效
        var windowWidth = $(window).width();
        if (windowWidth > 768) {
            document.write('<script type="text/javascript" src="/js/sakura.js" />');
        }
        </script>
    
   
        

</body>

</html>
